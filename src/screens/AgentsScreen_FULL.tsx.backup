// This is the full implementation - will be added incrementally
